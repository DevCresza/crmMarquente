<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

*No recent activity*
</claude-mem-context>

# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

CRM Marquente is a B2B CRM system for managing commercial registrations with integrations to Linx Commerce (ERP) and Flodesk (email marketing). Built with React 19 + TypeScript, Vite, Zustand for state management, and Supabase for backend services.

## Common Commands

```bash
npm run dev          # Start development server with HMR
npm run build        # TypeScript check + production build
npm run lint         # Check code with Biome
npm run lint:fix     # Auto-fix linting issues
npm run format       # Format code with Biome
npm test             # Run tests in watch mode
npm run test:run     # Run tests once (CI mode)
```

## Architecture

### Technology Stack
- **Frontend:** React 19, TypeScript 5.9, Vite 7
- **State:** Zustand with localStorage persistence
- **Backend:** Supabase (PostgreSQL, Auth, Edge Functions)
- **UI:** Radix UI primitives + Tailwind CSS + Framer Motion
- **Code Quality:** Biome (linting + formatting)
- **Testing:** Vitest + React Testing Library

### Key Directories
- `src/api/` - Supabase API layer (`supabaseApi.ts` contains all backend calls)
- `src/components/ui/` - Reusable Shadcn-style components built on Radix UI
- `src/components/crm/` - CRM-specific components (KanbanBoard)
- `src/pages/` - Route page components (Dashboard, CRM, B2BRegistration, UserManagement)
- `src/store/` - Zustand stores (authStore, registrationStore, userStore, themeStore)
- `src/hooks/` - Custom React hooks (useAuth, useMobile)
- `src/types/` - TypeScript type definitions
- `src/lib/` - Utilities and Supabase client initialization

### Data Flow
1. Pages fetch data via API functions in `src/api/supabaseApi.ts`
2. State is managed in Zustand stores (`src/store/`)
3. Edge Functions handle authentication (`auth-login`), user creation (`users`), and integrations (`process-registration`)

### Route Structure
- `/login` - Public authentication page
- `/` - Dashboard with KPIs (protected)
- `/crm` - Kanban/Table view of registrations (protected)
- `/cadastro-b2b` - B2B registration form (protected)
- `/users` - User management (admin-only)

### User Roles
`admin`, `cadastro`, `representante`, `user` - defined in `src/types/index.ts`

### B2B Registration Statuses
9 workflow statuses from `novo` â†’ `concluido` with color coding in `STATUS_CONFIG`

## Environment Variables

Required in `.env`:
```
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

For integrations (Edge Functions):
```
LINX_API_URL, LINX_API_KEY
FLODESK_API_KEY, FLODESK_WORKFLOW_ID, FLODESK_SEGMENT_ID
```

## Path Aliases

Use `@/` to import from `src/` directory:
```typescript
import { Button } from '@/components/ui/Button'
import { useAuth } from '@/hooks'
```

## Testing

Tests use Vitest with jsdom environment. Test files are colocated with source (`.test.ts` or `.test.tsx`).

```bash
npm test                    # Watch mode
npm run test:run            # Single run
npm run test:coverage       # With coverage
```

Mock Supabase client in tests - see `src/api/supabaseApi.test.ts` for examples.

## External Integrations

See `INTEGRACOES.md` for detailed documentation on:
- Linx Commerce integration (CLIFOR code generation for ERP)
- Flodesk email marketing automation (workflow triggers)
